<section class="homepage-container">
  <div class="toolbar">
    <input type="text" placeholder="Search routines..." [(ngModel)]="searchTerm" />
    <button (click)="goToCreate()">+ Create Routine</button>
  </div>

  <ul class="routine-list">
    @for (routine of filteredRoutines(); track routine.id) {
      <li class="routine-item">
        <div class="routine-header" (click)="toggleExpanded(routine.id)">
          <span>{{ routine.name }}</span>
          <button class="edit-btn" (click)="editRoutine(routine.id); $event.stopPropagation()">Edit</button>
        </div>

        @if (expandedId() === routine.id) {
          <div class="routine-details">
            <p><strong>Description:</strong> {{ routine.description }}</p>
            <p><strong>Start:</strong> {{ routine.startingDate | date }}</p>
            <p><strong>End:</strong> {{ routine.endingDate | date }}</p>
            <p><strong>Recurrence:</strong> {{ routine.reccurenceCoef }} time(s) per {{ routine.reccurence }}</p>
            @for (occurence of routine.listOccurences; track occurence.index) {
              <label [for]="routine.id + occurence.index">#{{ occurence.index }}</label>
              <input [id]="routine.id + occurence.index" type="checkbox" [checked]="occurence.checked" (change)="toggleOccurrence(routine.id, occurence.index, $event)">
            }
          </div>
        }
      </li>
    }
  </ul>
</section>
